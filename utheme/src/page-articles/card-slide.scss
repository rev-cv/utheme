@use 'sass:color' as sys;
@use "../conf.scss" as conf;
@use "../funcs.scss" as f;

@mixin styles {
    .article-card {
        position: relative;
        display: block;
        overflow: hidden;
        border-radius: f.get-radius("card");
        aspect-ratio: 3 / 4;
        background-color: conf.$color-section-light;
        transition: transform 0.4s cubic-bezier(0.19, 1, 0.22, 1), box-shadow 0.4s cubic-bezier(0.19, 1, 0.22, 1);

        @if conf.$is-border == 'true' {
            border: 1px solid conf.$color-border-light;
            @media (prefers-color-scheme: dark) {
                border-color: conf.$color-border-dark;
            }
        }

        @media (prefers-color-scheme: dark) {
            background-color: conf.$color-section-dark;
        }

        &:hover {
            transform: translateY(-10px);
            box-shadow: conf.$shadow-section-hover;

            .article-card__body {
                transform: translateY(0);
            }
        }

        &__link {
            position: absolute;
            inset: 0;
            z-index: 4;
        }

        picture {
            position: absolute;
            inset: 0;
            z-index: 1;

            img {
                width: 100%;
                height: 100%;
                object-fit: cover;
            }
        }

        &__body {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            z-index: 3;
            
            transform: translateY(calc(100% - 6.5rem - 1rem)); 
            transition: transform 0.4s cubic-bezier(0.19, 1, 0.22, 1);

            h3 {
                margin: 0;
                padding: 2.5rem 1.25rem 1.25rem;
                line-height: 1.3;
                font-size: clamp(1rem, 2vw, 1.1rem);
                font-weight: 700;
                color: conf.$color-text-light;
                
                background: linear-gradient(to top, rgba(conf.$color-section-light, 85%) 85%, transparent);

                display: -webkit-box;
                -webkit-box-orient: vertical;
                -webkit-line-clamp: 3;
                max-height: 6em;
                overflow: hidden;
                text-overflow: ellipsis;

                @media (prefers-color-scheme: dark) {
                    color: conf.$color-text-dark;
                    background: linear-gradient(to top, rgba(conf.$color-section-dark, 85%) 85%, transparent);
                }
            }

            p {
                margin: 0;
                padding: 1.25rem;
                background: rgba(conf.$color-section-light, 85%);
                font-size: 0.9rem;
                line-height: 1.5;
                color: rgba(conf.$color-text-light, 0.8);

                // Ограничение по строкам (стандарт для Webkit)
                display: -webkit-box;
                -webkit-box-orient: vertical;
                -webkit-line-clamp: 5;
                overflow: hidden; 
                text-overflow: ellipsis;

                // Жёсткое ограничение высоты для "чистой" обрезки
                // 0.9rem (размер) * 1.5 (интервал) * 5 (строк)
                max-height: 6.75rem;

                @media (prefers-color-scheme: dark) {
                    background: rgba(conf.$color-section-dark, 85%);
                    color: rgba(conf.$color-text-dark, 0.8);
                }
            }
        }
    }
}
